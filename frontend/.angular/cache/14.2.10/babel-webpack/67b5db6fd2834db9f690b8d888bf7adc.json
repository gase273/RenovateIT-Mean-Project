{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Pc/Desktop/RTI 3. god/6. semestar/PIA/Projekat/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/user.service\";\nimport * as i2 from \"@angular/router\";\nexport class AddAgencyComponent {\n  constructor(userService, router) {\n    this.userService = userService;\n    this.router = router;\n    this.badChosen = false;\n    this.registerFail = false;\n  }\n\n  ngOnInit() {\n    this.userService.fetchUsers().subscribe(users => this.allUsers = users); //dovlaci sve korisnike na front da se proveri jedinstvenost, nije najbolje znam\n  }\n\n  fileChosen(event) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      //izbor slike i provera validnosti\n      if (event.target.value) {\n        _this.img = event.target.files[0];\n        let img = new Image();\n        img.src = URL.createObjectURL(_this.img);\n        yield img.decode();\n        if (img.naturalWidth < 100 || img.naturalWidth > 300 || img.naturalHeight < 100 || img.naturalHeight > 300) _this.badChosen = true;else _this.badChosen = false;\n      } else {\n        _this.badChosen = false;\n        _this.img = null;\n      }\n    })();\n  }\n\n  registerAgency() {\n    //ako kor ime i email nisu jedinstveni nista se ne radi\n    for (let u of this.allUsers) {\n      if (this.username == u.username) {\n        alert(\"Korisnicko ime nije jedinstveno!\");\n        return;\n      }\n\n      if (this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    let form = new FormData(); //registracija\n\n    form.append(\"profile_pic\", this.img);\n    form.append(\"username\", this.username);\n    form.append(\"password\", this.password);\n    form.append(\"phone\", this.phone);\n    form.append(\"email\", this.email);\n    form.append(\"agencyname\", this.agencyName);\n    form.append(\"address\", this.address);\n    form.append(\"pib\", this.pib);\n    form.append(\"desc\", this.desc);\n    this.userService.addAgency(form).subscribe(response => {\n      if (response['status'] == \"ok\") this.router.navigate(['/admin']);else this.registerFail = true;\n    });\n  }\n\n}\n\nAddAgencyComponent.ɵfac = function AddAgencyComponent_Factory(t) {\n  return new (t || AddAgencyComponent)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.Router));\n};\n\nAddAgencyComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AddAgencyComponent,\n  selectors: [[\"app-add-agency\"]],\n  decls: 2,\n  vars: 0,\n  template: function AddAgencyComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\");\n      i0.ɵɵtext(1, \"add-agency works!\");\n      i0.ɵɵelementEnd();\n    }\n  },\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhZGQtYWdlbmN5LmNvbXBvbmVudC5jc3MifQ== */\"]\n});","map":{"version":3,"mappings":";;;;AAUA,OAAM,MAAOA,kBAAP,CAAyB;EAgB7BC,YAAoBC,WAApB,EAAsDC,MAAtD,EAAoE;IAAhD;IAAkC;IAJtD,iBAAqB,KAArB;IAEA,oBAAwB,KAAxB;EAEyE;;EAEzEC,QAAQ;IAEN,KAAKF,WAAL,CAAiBG,UAAjB,GAA8BC,SAA9B,CAAyCC,KAAD,IAAmB,KAAKC,QAAL,GAAgBD,KAA3E,EAFM,CAEgF;EACvF;;EAEKE,UAAU,CAACC,KAAD,EAAU;IAAA;;IAAA;MACxB;MACA,IAAGA,KAAK,CAACC,MAAN,CAAaC,KAAhB,EAAuB;QACrB,KAAI,CAACC,GAAL,GAAiBH,KAAK,CAACC,MAAN,CAAaG,KAAb,CAAmB,CAAnB,CAAjB;QACA,IAAID,GAAG,GAAG,IAAIE,KAAJ,EAAV;QACAF,GAAG,CAACG,GAAJ,GAAUC,GAAG,CAACC,eAAJ,CAAoB,KAAI,CAACL,GAAzB,CAAV;QACA,MAAMA,GAAG,CAACM,MAAJ,EAAN;QACA,IAAGN,GAAG,CAACO,YAAJ,GAAmB,GAAnB,IAA0BP,GAAG,CAACO,YAAJ,GAAmB,GAA7C,IAAoDP,GAAG,CAACQ,aAAJ,GAAoB,GAAxE,IAA+ER,GAAG,CAACQ,aAAJ,GAAoB,GAAtG,EAA2G,KAAI,CAACC,SAAL,GAAiB,IAAjB,CAA3G,KACK,KAAI,CAACA,SAAL,GAAiB,KAAjB;MACN,CAPD,MAQK;QACH,KAAI,CAACA,SAAL,GAAiB,KAAjB;QACA,KAAI,CAACT,GAAL,GAAW,IAAX;MACD;IAbuB;EAczB;;EAEDU,cAAc;IACZ;IACA,KAAI,IAAIC,CAAR,IAAa,KAAKhB,QAAlB,EAA4B;MAC1B,IAAG,KAAKiB,QAAL,IAAiBD,CAAC,CAACC,QAAtB,EAAgC;QAC9BC,KAAK,CAAC,kCAAD,CAAL;QACA;MACD;;MACD,IAAG,KAAKC,KAAL,IAAcH,CAAC,CAACG,KAAnB,EAA0B;QACxBD,KAAK,CAAC,wBAAD,CAAL;QACA;MACD;IACF;;IAED,IAAIE,IAAI,GAAG,IAAIC,QAAJ,EAAX,CAbY,CAcZ;;IACAD,IAAI,CAACE,MAAL,CAAY,aAAZ,EAA2B,KAAKjB,GAAhC;IACAe,IAAI,CAACE,MAAL,CAAY,UAAZ,EAAwB,KAAKL,QAA7B;IACAG,IAAI,CAACE,MAAL,CAAY,UAAZ,EAAwB,KAAKC,QAA7B;IACAH,IAAI,CAACE,MAAL,CAAY,OAAZ,EAAqB,KAAKE,KAA1B;IACAJ,IAAI,CAACE,MAAL,CAAY,OAAZ,EAAqB,KAAKH,KAA1B;IACAC,IAAI,CAACE,MAAL,CAAY,YAAZ,EAA0B,KAAKG,UAA/B;IACAL,IAAI,CAACE,MAAL,CAAY,SAAZ,EAAuB,KAAKI,OAA5B;IACAN,IAAI,CAACE,MAAL,CAAY,KAAZ,EAAmB,KAAKK,GAAxB;IACAP,IAAI,CAACE,MAAL,CAAY,MAAZ,EAAoB,KAAKM,IAAzB;IACA,KAAKlC,WAAL,CAAiBmC,SAAjB,CAA2BT,IAA3B,EAAiCtB,SAAjC,CAA4CgC,QAAD,IAAa;MACtD,IAAIA,QAAQ,CAAC,QAAD,CAAR,IAAsB,IAA1B,EAAgC,KAAKnC,MAAL,CAAYoC,QAAZ,CAAqB,CAAC,QAAD,CAArB,EAAhC,KACK,KAAKC,YAAL,GAAoB,IAApB;IAEN,CAJD;EAKD;;AApE4B;;;mBAAlBxC,oBAAkByC;AAAA;;;QAAlBzC;EAAkB0C;EAAAC;EAAAC;EAAAC;IAAA;MCV/BJ;MAAGA;MAAiBA","names":["AddAgencyComponent","constructor","userService","router","ngOnInit","fetchUsers","subscribe","users","allUsers","fileChosen","event","target","value","img","files","Image","src","URL","createObjectURL","decode","naturalWidth","naturalHeight","badChosen","registerAgency","u","username","alert","email","form","FormData","append","password","phone","agencyName","address","pib","desc","addAgency","response","navigate","registerFail","i0","selectors","decls","vars","template"],"sourceRoot":"","sources":["C:\\Users\\Pc\\Desktop\\RTI 3. god\\6. semestar\\PIA\\Projekat\\frontend\\src\\app\\add-agency\\add-agency.component.ts","C:\\Users\\Pc\\Desktop\\RTI 3. god\\6. semestar\\PIA\\Projekat\\frontend\\src\\app\\add-agency\\add-agency.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { User } from '../models/user';\nimport { UserService } from '../services/user.service';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-add-agency',\n  templateUrl: './add-agency.component.html',\n  styleUrls: ['./add-agency.component.css']\n})\nexport class AddAgencyComponent implements OnInit {\n\n  agencyName: string\n  address: string\n  pib: string\n  desc: string\n  username: string\n  password: string\n  email: string\n  phone: string\n  confirm: string\n  img: File\n  badChosen: boolean = false\n  allUsers: User[]\n  registerFail: boolean = false\n\n  constructor(private userService: UserService, private router: Router) { }\n\n  ngOnInit(): void {\n\n    this.userService.fetchUsers().subscribe((users: User[]) => this.allUsers = users)     //dovlaci sve korisnike na front da se proveri jedinstvenost, nije najbolje znam\n  }\n\n  async fileChosen(event:any) {\n    //izbor slike i provera validnosti\n    if(event.target.value) {\n      this.img = <File>event.target.files[0]\n      let img = new Image();\n      img.src = URL.createObjectURL(this.img);\n      await img.decode();\n      if(img.naturalWidth < 100 || img.naturalWidth > 300 || img.naturalHeight < 100 || img.naturalHeight > 300) this.badChosen = true;\n      else this.badChosen = false;\n    }\n    else {\n      this.badChosen = false;\n      this.img = null;\n    }\n  }\n\n  registerAgency() {\n    //ako kor ime i email nisu jedinstveni nista se ne radi\n    for(let u of this.allUsers) {\n      if(this.username == u.username) {\n        alert(\"Korisnicko ime nije jedinstveno!\");\n        return;\n      }\n      if(this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    let form = new FormData();\n    //registracija\n    form.append(\"profile_pic\", this.img)\n    form.append(\"username\", this.username)\n    form.append(\"password\", this.password)\n    form.append(\"phone\", this.phone)\n    form.append(\"email\", this.email)\n    form.append(\"agencyname\", this.agencyName)\n    form.append(\"address\", this.address)\n    form.append(\"pib\", this.pib)\n    form.append(\"desc\", this.desc)\n    this.userService.addAgency(form).subscribe((response) => {\n      if (response['status'] == \"ok\") this.router.navigate(['/admin']);\n      else this.registerFail = true;\n\n    });\n  }\n}\n\n","<p>add-agency works!</p>\n"]},"metadata":{},"sourceType":"module"}