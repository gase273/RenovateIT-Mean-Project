{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.validateSchemaDeps = exports.validatePropertyDeps = exports.error = void 0;\n\nconst codegen_1 = require(\"../../compile/codegen\");\n\nconst util_1 = require(\"../../compile/util\");\n\nconst code_1 = require(\"../code\");\n\nexports.error = {\n  message: ({\n    params: {\n      property,\n      depsCount,\n      deps\n    }\n  }) => {\n    const property_ies = depsCount === 1 ? \"property\" : \"properties\";\n    return (0, codegen_1.str)`must have ${property_ies} ${deps} when property ${property} is present`;\n  },\n  params: ({\n    params: {\n      property,\n      depsCount,\n      deps,\n      missingProperty\n    }\n  }) => (0, codegen_1._)`{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}` // TODO change to reference\n\n};\nconst def = {\n  keyword: \"dependencies\",\n  type: \"object\",\n  schemaType: \"object\",\n  error: exports.error,\n\n  code(cxt) {\n    const [propDeps, schDeps] = splitDependencies(cxt);\n    validatePropertyDeps(cxt, propDeps);\n    validateSchemaDeps(cxt, schDeps);\n  }\n\n};\n\nfunction splitDependencies({\n  schema\n}) {\n  const propertyDeps = {};\n  const schemaDeps = {};\n\n  for (const key in schema) {\n    if (key === \"__proto__\") continue;\n    const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps;\n    deps[key] = schema[key];\n  }\n\n  return [propertyDeps, schemaDeps];\n}\n\nfunction validatePropertyDeps(cxt, propertyDeps = cxt.schema) {\n  const {\n    gen,\n    data,\n    it\n  } = cxt;\n  if (Object.keys(propertyDeps).length === 0) return;\n  const missing = gen.let(\"missing\");\n\n  for (const prop in propertyDeps) {\n    const deps = propertyDeps[prop];\n    if (deps.length === 0) continue;\n    const hasProperty = (0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties);\n    cxt.setParams({\n      property: prop,\n      depsCount: deps.length,\n      deps: deps.join(\", \")\n    });\n\n    if (it.allErrors) {\n      gen.if(hasProperty, () => {\n        for (const depProp of deps) {\n          (0, code_1.checkReportMissingProp)(cxt, depProp);\n        }\n      });\n    } else {\n      gen.if((0, codegen_1._)`${hasProperty} && (${(0, code_1.checkMissingProp)(cxt, deps, missing)})`);\n      (0, code_1.reportMissingProp)(cxt, missing);\n      gen.else();\n    }\n  }\n}\n\nexports.validatePropertyDeps = validatePropertyDeps;\n\nfunction validateSchemaDeps(cxt, schemaDeps = cxt.schema) {\n  const {\n    gen,\n    data,\n    keyword,\n    it\n  } = cxt;\n  const valid = gen.name(\"valid\");\n\n  for (const prop in schemaDeps) {\n    if ((0, util_1.alwaysValidSchema)(it, schemaDeps[prop])) continue;\n    gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties), () => {\n      const schCxt = cxt.subschema({\n        keyword,\n        schemaProp: prop\n      }, valid);\n      cxt.mergeValidEvaluated(schCxt, valid);\n    }, () => gen.var(valid, true) // TODO var\n    );\n    cxt.ok(valid);\n  }\n}\n\nexports.validateSchemaDeps = validateSchemaDeps;\nexports.default = def;","map":{"version":3,"names":["Object","defineProperty","exports","value","validateSchemaDeps","validatePropertyDeps","error","codegen_1","require","util_1","code_1","message","params","property","depsCount","deps","property_ies","str","missingProperty","_","def","keyword","type","schemaType","code","cxt","propDeps","schDeps","splitDependencies","schema","propertyDeps","schemaDeps","key","Array","isArray","gen","data","it","keys","length","missing","let","prop","hasProperty","propertyInData","opts","ownProperties","setParams","join","allErrors","if","depProp","checkReportMissingProp","checkMissingProp","reportMissingProp","else","valid","name","alwaysValidSchema","schCxt","subschema","schemaProp","mergeValidEvaluated","var","ok","default"],"sources":["C:/Users/Pc/Desktop/RTI 3. god/6. semestar/PIA/Projekat/frontend/node_modules/ajv/dist/vocabularies/applicator/dependencies.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validateSchemaDeps = exports.validatePropertyDeps = exports.error = void 0;\nconst codegen_1 = require(\"../../compile/codegen\");\nconst util_1 = require(\"../../compile/util\");\nconst code_1 = require(\"../code\");\nexports.error = {\n    message: ({ params: { property, depsCount, deps } }) => {\n        const property_ies = depsCount === 1 ? \"property\" : \"properties\";\n        return (0, codegen_1.str) `must have ${property_ies} ${deps} when property ${property} is present`;\n    },\n    params: ({ params: { property, depsCount, deps, missingProperty } }) => (0, codegen_1._) `{property: ${property},\n    missingProperty: ${missingProperty},\n    depsCount: ${depsCount},\n    deps: ${deps}}`, // TODO change to reference\n};\nconst def = {\n    keyword: \"dependencies\",\n    type: \"object\",\n    schemaType: \"object\",\n    error: exports.error,\n    code(cxt) {\n        const [propDeps, schDeps] = splitDependencies(cxt);\n        validatePropertyDeps(cxt, propDeps);\n        validateSchemaDeps(cxt, schDeps);\n    },\n};\nfunction splitDependencies({ schema }) {\n    const propertyDeps = {};\n    const schemaDeps = {};\n    for (const key in schema) {\n        if (key === \"__proto__\")\n            continue;\n        const deps = Array.isArray(schema[key]) ? propertyDeps : schemaDeps;\n        deps[key] = schema[key];\n    }\n    return [propertyDeps, schemaDeps];\n}\nfunction validatePropertyDeps(cxt, propertyDeps = cxt.schema) {\n    const { gen, data, it } = cxt;\n    if (Object.keys(propertyDeps).length === 0)\n        return;\n    const missing = gen.let(\"missing\");\n    for (const prop in propertyDeps) {\n        const deps = propertyDeps[prop];\n        if (deps.length === 0)\n            continue;\n        const hasProperty = (0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties);\n        cxt.setParams({\n            property: prop,\n            depsCount: deps.length,\n            deps: deps.join(\", \"),\n        });\n        if (it.allErrors) {\n            gen.if(hasProperty, () => {\n                for (const depProp of deps) {\n                    (0, code_1.checkReportMissingProp)(cxt, depProp);\n                }\n            });\n        }\n        else {\n            gen.if((0, codegen_1._) `${hasProperty} && (${(0, code_1.checkMissingProp)(cxt, deps, missing)})`);\n            (0, code_1.reportMissingProp)(cxt, missing);\n            gen.else();\n        }\n    }\n}\nexports.validatePropertyDeps = validatePropertyDeps;\nfunction validateSchemaDeps(cxt, schemaDeps = cxt.schema) {\n    const { gen, data, keyword, it } = cxt;\n    const valid = gen.name(\"valid\");\n    for (const prop in schemaDeps) {\n        if ((0, util_1.alwaysValidSchema)(it, schemaDeps[prop]))\n            continue;\n        gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties), () => {\n            const schCxt = cxt.subschema({ keyword, schemaProp: prop }, valid);\n            cxt.mergeValidEvaluated(schCxt, valid);\n        }, () => gen.var(valid, true) // TODO var\n        );\n        cxt.ok(valid);\n    }\n}\nexports.validateSchemaDeps = validateSchemaDeps;\nexports.default = def;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}