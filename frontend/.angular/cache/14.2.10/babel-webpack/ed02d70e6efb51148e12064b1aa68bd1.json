{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Pc/Desktop/RTI 3. god/6. semestar/PIA/Projekat/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../services/user.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../navbar/navbar.component\";\nimport * as i6 from \"../footer/footer.component\";\n\nfunction AgencyComponent_div_30_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 7);\n    i0.ɵɵtext(1, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_div_30_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 7);\n    i0.ɵɵtext(1, \"Nije validan format mejla.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, AgencyComponent_div_30_small_1_Template, 2, 0, \"small\", 42);\n    i0.ɵɵtemplate(2, AgencyComponent_div_30_small_2_Template, 2, 0, \"small\", 42);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r4 = i0.ɵɵreference(29);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r4.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r4.errors[\"pattern\"]);\n  }\n}\n\nfunction AgencyComponent_div_35_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 7);\n    i0.ɵɵtext(1, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_div_35_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 7);\n    i0.ɵɵtext(1, \"Telefon se navodi u formatu 06 (ili +3816), zatim Vas broj bez razmaka ili crtica.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, AgencyComponent_div_35_small_1_Template, 2, 0, \"small\", 42);\n    i0.ɵɵtemplate(2, AgencyComponent_div_35_small_2_Template, 2, 0, \"small\", 42);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r6 = i0.ɵɵreference(34);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r6.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r6.errors[\"pattern\"]);\n  }\n}\n\nfunction AgencyComponent_small_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 43);\n    i0.ɵɵtext(1, \"Uspe\\u0161na izmena podataka!\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_small_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 33);\n    i0.ɵɵtext(1, \"Gre\\u0161ka pri izmeni podataka!\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_div_51_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 7);\n    i0.ɵɵtext(1, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_div_51_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 7);\n    i0.ɵɵtext(1, \"Lozinka mora imati izmedju 7 i 12 karaktera, jedno veliko slovo, jednu cifru i jedan specijalan karakter i mora pocinjati slovom.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_div_51_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, AgencyComponent_div_51_small_1_Template, 2, 0, \"small\", 42);\n    i0.ɵɵtemplate(2, AgencyComponent_div_51_small_2_Template, 2, 0, \"small\", 42);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r11 = i0.ɵɵreference(50);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r11.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r11.errors[\"pattern\"]);\n  }\n}\n\nfunction AgencyComponent_small_59_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 43);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r14.passChangeText);\n  }\n}\n\nfunction AgencyComponent_small_60_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r15.passChangeText);\n  }\n}\n\nfunction AgencyComponent_small_68_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 44);\n    i0.ɵɵtext(1, \"Slika mora biti velicine 100x100px - 300x300px.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AgencyComponent_small_71_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 43);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r17 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r17.imgChangeText);\n  }\n}\n\nfunction AgencyComponent_small_72_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r18.imgChangeText);\n  }\n}\n\nexport class AgencyComponent {\n  constructor(router, usrService) {\n    this.router = router;\n    this.usrService = usrService;\n    this.dataChange = false;\n    this.dataChangeFail = false;\n    this.passChange = false;\n    this.passChangeFail = false;\n    this.badChosen = false;\n    this.imgChange = false;\n    this.imgChangeFail = false;\n  }\n\n  ngOnInit() {\n    this.logged = JSON.parse(sessionStorage.getItem(\"loggedIn\"));\n\n    if (this.logged && this.logged.type == 1) {\n      this.agencyName = this.logged.agencyName;\n      this.address = this.logged.address;\n      this.desc = this.logged.desc;\n      this.email = this.logged.email;\n      this.phone = this.logged.phone;\n      this.usrService.fetchUsers().subscribe(users => {\n        this.allUsers = users;\n      });\n    } else this.router.navigate(['']);\n  }\n\n  changeData() {\n    for (let u of this.allUsers) {\n      if (this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    this.usrService.editAgencyData(this.logged.username, this.logged.agencyName, this.address, this.desc, this.email, this.phone).subscribe(response => {\n      if (response['status'] == \"ok\") {\n        //podaci izmenjeni u bazi, sada moraju da se izmene u sessionStorage\n        this.dataChange = true;\n        this.logged.agencyName = this.agencyName;\n        this.logged.address = this.address;\n        this.logged.desc = this.desc;\n        this.logged.phone = this.phone;\n        this.logged.email = this.email;\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n      } else this.dataChangeFail = true;\n    });\n  }\n\n  changePass() {\n    this.usrService.editPassword(this.logged.username, this.password, this.newPassword).subscribe(response => {\n      if (response) {\n        //sifra je uspesno promenjena ako se poklopio jedan korisnik, a to se desi ako je user+pass kombinacija dobra\n        if (response['matchedCount'] == 1) {\n          this.passChange = true;\n          this.passChangeText = \"Uspešno izmenjena lozinka!\";\n          this.logged.password = this.password;\n          sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n        } else {\n          this.passChangeFail = true;\n          this.passChangeText = \"Pogrešno uneta stara lozinka!\";\n        }\n      } else {\n        this.passChangeFail = true;\n        this.passChangeText = \"Greška pri izmeni lozinke!\";\n      }\n    });\n  }\n\n  fileChosen(event) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      //isto kao kod registracije\n      if (event.target.value) {\n        _this.img = event.target.files[0];\n        let img = new Image();\n        img.src = URL.createObjectURL(_this.img);\n        yield img.decode();\n        if (img.naturalWidth < 100 || img.naturalWidth > 300 || img.naturalHeight < 100 || img.naturalHeight > 300) _this.badChosen = true;else _this.badChosen = false;\n      } else {\n        _this.badChosen = false;\n        _this.img = null;\n      }\n    })();\n  }\n\n  changeImg() {\n    //isto kao kod registracije\n    let form = new FormData();\n    form.append(\"profile_pic\", this.img);\n    form.append(\"user\", this.logged.username);\n    this.usrService.editImg(form).subscribe(response => {\n      if (response['status'] == 'ok') {\n        this.imgChange = true;\n        this.imgChangeText = \"Ikonica uspešno izmenjena!\";\n        this.logged.img = response[\"newImg\"];\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n        this.ngOnInit();\n      } else {\n        this.imgChangeFail = true;\n        this.imgChangeText = \"Greška pri izmeni ikonice!\";\n      }\n    });\n  }\n\n}\n\nAgencyComponent.ɵfac = function AgencyComponent_Factory(t) {\n  return new (t || AgencyComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.UserService));\n};\n\nAgencyComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AgencyComponent,\n  selectors: [[\"app-agency\"]],\n  decls: 74,\n  vars: 46,\n  consts: [[1, \"container\", \"mb-5\", \"mt-5\"], [1, \"row\"], [1, \"col-md-6\"], [\"changeForm\", \"ngForm\"], [\"for\", \"agencyname\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"agencyname\", \"name\", \"agencyname\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Agencyname\", \"ngModel\"], [1, \"text-danger\"], [\"for\", \"address\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"address\", \"name\", \"address\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Address\", \"ngModel\"], [\"for\", \"desc\", 1, \"form-label\"], [\"id\", \"desc\", \"name\", \"desc\", \"rows\", \"3\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Desc\", \"ngModel\"], [\"for\", \"email\", 1, \"form-label\"], [\"type\", \"email\", \"id\", \"email\", \"name\", \"email\", \"pattern\", \"[^@ \\\\t\\\\r\\\\n]+@[^@ \\\\t\\\\r\\\\n]+\\\\.[^@ \\\\t\\\\r\\\\n]+\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Email\", \"ngModel\"], [4, \"ngIf\"], [\"for\", \"phone\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"phone\", \"name\", \"phone\", \"pattern\", \"^(\\\\+)(3816)([0-9]){6,9}|(06)([0-9]){6,9}$\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Phone\", \"ngModel\"], [\"type\", \"submit\", \"value\", \"Izmeni podatke\", 1, \"btn\", \"btn-primary\", \"mt-2\", 3, \"disabled\", \"click\"], [\"class\", \"text-success d-block\", 4, \"ngIf\"], [\"class\", \"text-danger d-block\", 4, \"ngIf\"], [\"passForm\", \"ngForm\"], [\"for\", \"password\", 1, \"form-label\"], [\"type\", \"password\", \"name\", \"password\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"newPassword\", 1, \"form-label\"], [\"type\", \"password\", \"id\", \"newPassword\", \"name\", \"newPassword\", \"pattern\", \"^(?=[A-Za-z]*?[A-Za-z])(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$ %^&*-]).{7,12}$\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"newPass\", \"ngModel\"], [\"for\", \"confirm\", 1, \"form-label\"], [\"type\", \"password\", \"id\", \"confirm\", \"name\", \"confirm\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Confirm\", \"ngModel\"], [1, \"text-danger\", \"d-block\"], [\"type\", \"submit\", \"value\", \"Izmeni lozinku\", 1, \"btn\", \"btn-primary\", \"mt-2\", 3, \"disabled\", \"click\"], [1, \"col-md-6\", \"d-flex\", \"flex-column\", \"align-items-center\"], [1, \"text-center\"], [\"alt\", \"Slika nije prona\\u0111ena\", 1, \"rounded\", 3, \"src\"], [\"for\", \"profile_pic\", 1, \"form-label\", \"mt-2\"], [\"type\", \"file\", \"id\", \"profile_pic\", \"name\", \"profile_pic\", \"accept\", \".png, .jpg, .jpeg\", 1, \"form-control\", \"w-50\", 3, \"input\"], [\"class\", \"text-danger w-50\", 4, \"ngIf\"], [1, \"btn\", \"btn-primary\", \"mt-3\", 3, \"disabled\", \"click\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [1, \"text-success\", \"d-block\"], [1, \"text-danger\", \"w-50\"]],\n  template: function AgencyComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-navbar\");\n      i0.ɵɵelementStart(1, \"div\", 0)(2, \"h4\");\n      i0.ɵɵtext(3, \"Izmena podataka\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"div\", 1)(5, \"div\", 2)(6, \"form\", null, 3)(8, \"label\", 4);\n      i0.ɵɵtext(9, \"Ime Agencije:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"input\", 5, 6);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_input_ngModelChange_10_listener($event) {\n        return ctx.agencyName = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"small\", 7);\n      i0.ɵɵtext(13, \"Ovo polje je obavezno.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"label\", 8);\n      i0.ɵɵtext(15, \"Adresa:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"input\", 9, 10);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_input_ngModelChange_16_listener($event) {\n        return ctx.address = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"small\", 7);\n      i0.ɵɵtext(19, \"Ovo polje je obavezno.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"label\", 11);\n      i0.ɵɵtext(21, \"Opis:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(22, \"textarea\", 12, 13);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_textarea_ngModelChange_22_listener($event) {\n        return ctx.desc = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"small\", 7);\n      i0.ɵɵtext(25, \"Ovo polje je obavezno.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"label\", 14);\n      i0.ɵɵtext(27, \"Email:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"input\", 15, 16);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_input_ngModelChange_28_listener($event) {\n        return ctx.email = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(30, AgencyComponent_div_30_Template, 3, 2, \"div\", 17);\n      i0.ɵɵelementStart(31, \"label\", 18);\n      i0.ɵɵtext(32, \"Broj Telefona:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(33, \"input\", 19, 20);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_input_ngModelChange_33_listener($event) {\n        return ctx.phone = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(35, AgencyComponent_div_35_Template, 3, 2, \"div\", 17);\n      i0.ɵɵelementStart(36, \"input\", 21);\n      i0.ɵɵlistener(\"click\", function AgencyComponent_Template_input_click_36_listener() {\n        return ctx.changeData();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(37, AgencyComponent_small_37_Template, 2, 0, \"small\", 22);\n      i0.ɵɵtemplate(38, AgencyComponent_small_38_Template, 2, 0, \"small\", 23);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(39, \"hr\");\n      i0.ɵɵelementStart(40, \"h4\");\n      i0.ɵɵtext(41, \"Izmena Lozinke\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(42, \"form\", null, 24)(44, \"label\", 25);\n      i0.ɵɵtext(45, \"Lozinka:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(46, \"input\", 26);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_input_ngModelChange_46_listener($event) {\n        return ctx.password = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(47, \"label\", 27);\n      i0.ɵɵtext(48, \"Nova Lozinka:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(49, \"input\", 28, 29);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_input_ngModelChange_49_listener($event) {\n        return ctx.newPassword = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(51, AgencyComponent_div_51_Template, 3, 2, \"div\", 17);\n      i0.ɵɵelementStart(52, \"label\", 30);\n      i0.ɵɵtext(53, \"Ponovi Lozinku:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(54, \"input\", 31, 32);\n      i0.ɵɵlistener(\"ngModelChange\", function AgencyComponent_Template_input_ngModelChange_54_listener($event) {\n        return ctx.confirm = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(56, \"small\", 33);\n      i0.ɵɵtext(57, \"Lozinke se ne poklapaju.\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(58, \"input\", 34);\n      i0.ɵɵlistener(\"click\", function AgencyComponent_Template_input_click_58_listener() {\n        return ctx.changePass();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(59, AgencyComponent_small_59_Template, 2, 1, \"small\", 22);\n      i0.ɵɵtemplate(60, AgencyComponent_small_60_Template, 2, 1, \"small\", 23);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(61, \"div\", 35)(62, \"h4\", 36);\n      i0.ɵɵtext(63, \"Trenutna Profilna Ikonica\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(64, \"img\", 37);\n      i0.ɵɵelementStart(65, \"label\", 38);\n      i0.ɵɵtext(66, \"Nova Profilna Ikonica:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(67, \"input\", 39);\n      i0.ɵɵlistener(\"input\", function AgencyComponent_Template_input_input_67_listener($event) {\n        return ctx.fileChosen($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(68, AgencyComponent_small_68_Template, 2, 0, \"small\", 40);\n      i0.ɵɵelementStart(69, \"button\", 41);\n      i0.ɵɵlistener(\"click\", function AgencyComponent_Template_button_click_69_listener() {\n        return ctx.changeImg();\n      });\n      i0.ɵɵtext(70, \"Izmenite Profilnu Ikonicu\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(71, AgencyComponent_small_71_Template, 2, 1, \"small\", 22);\n      i0.ɵɵtemplate(72, AgencyComponent_small_72_Template, 2, 1, \"small\", 23);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelement(73, \"app-footer\");\n    }\n\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(7);\n\n      const _r1 = i0.ɵɵreference(11);\n\n      const _r2 = i0.ɵɵreference(17);\n\n      const _r3 = i0.ɵɵreference(23);\n\n      const _r4 = i0.ɵɵreference(29);\n\n      const _r6 = i0.ɵɵreference(34);\n\n      const _r10 = i0.ɵɵreference(43);\n\n      const _r11 = i0.ɵɵreference(50);\n\n      const _r13 = i0.ɵɵreference(55);\n\n      i0.ɵɵadvance(10);\n      i0.ɵɵclassProp(\"is-invalid\", _r1.invalid && _r1.touched);\n      i0.ɵɵproperty(\"ngModel\", ctx.agencyName);\n      i0.ɵɵadvance(2);\n      i0.ɵɵclassProp(\"d-none\", _r1.valid || _r1.untouched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵclassProp(\"is-invalid\", _r2.invalid && _r2.touched);\n      i0.ɵɵproperty(\"ngModel\", ctx.address);\n      i0.ɵɵadvance(2);\n      i0.ɵɵclassProp(\"d-none\", _r2.valid || _r2.untouched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵclassProp(\"is-invalid\", _r3.invalid && _r3.touched);\n      i0.ɵɵproperty(\"ngModel\", ctx.desc);\n      i0.ɵɵadvance(2);\n      i0.ɵɵclassProp(\"d-none\", _r3.valid || _r3.untouched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵclassProp(\"is-invalid\", _r4.invalid && _r4.touched);\n      i0.ɵɵproperty(\"ngModel\", ctx.email);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", _r4.errors && _r4.invalid && _r4.touched);\n      i0.ɵɵadvance(3);\n      i0.ɵɵclassProp(\"is-invalid\", _r6.invalid && _r6.touched);\n      i0.ɵɵproperty(\"ngModel\", ctx.phone);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", _r6.errors && _r6.invalid && _r6.touched);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", _r0.form.invalid || _r0.form.pristine || _r0.submitted);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.dataChange);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.dataChangeFail);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngModel\", ctx.password);\n      i0.ɵɵadvance(3);\n      i0.ɵɵclassProp(\"is-invalid\", _r11.invalid && _r11.touched);\n      i0.ɵɵproperty(\"ngModel\", ctx.newPassword);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", _r11.errors && _r11.invalid && _r11.touched);\n      i0.ɵɵadvance(3);\n      i0.ɵɵclassProp(\"is-invalid\", _r13.value != _r11.value && _r13.touched);\n      i0.ɵɵproperty(\"ngModel\", ctx.confirm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵclassProp(\"d-none\", _r13.value == _r11.value || _r13.untouched);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", _r10.form.invalid || _r13.value != _r11.value || _r10.submitted);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.passChange);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.passChangeFail);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"src\", \"http://localhost:4000/images/\" + ctx.logged.img, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(3);\n      i0.ɵɵclassProp(\"is-invalid\", ctx.badChosen);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.badChosen);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", ctx.badChosen || !ctx.img);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.imgChange);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.imgChangeFail);\n    }\n  },\n  dependencies: [i3.NgIf, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.PatternValidator, i4.NgModel, i4.NgForm, i5.NavbarComponent, i6.FooterComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhZ2VuY3kuY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","AgencyComponent","constructor","router","usrService","ngOnInit","logged","JSON","parse","sessionStorage","getItem","type","agencyName","address","desc","email","phone","fetchUsers","subscribe","users","allUsers","navigate","changeData","u","alert","editAgencyData","username","response","dataChange","setItem","stringify","dataChangeFail","changePass","editPassword","password","newPassword","passChange","passChangeText","passChangeFail","fileChosen","event","target","value","img","files","Image","src","URL","createObjectURL","decode","naturalWidth","naturalHeight","badChosen","changeImg","form","FormData","append","editImg","imgChange","imgChangeText","imgChangeFail","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Pc\\Desktop\\RTI 3. god\\6. semestar\\PIA\\Projekat\\frontend\\src\\app\\agency\\agency.component.html","C:\\Users\\Pc\\Desktop\\RTI 3. god\\6. semestar\\PIA\\Projekat\\frontend\\src\\app\\agency\\agency.component.ts"],"sourcesContent":["<app-navbar></app-navbar>\n\n<div class=\"container mb-5 mt-5\">\n  <h4>Izmena podataka</h4>\n\n  <div class=\"row\">\n    <div class=\"col-md-6\">\n      <form #changeForm=\"ngForm\">\n        <label for=\"agencyname\" class=\"form-label\">Ime Agencije:</label>\n        <input type=\"text\" id=\"agencyname\" name=\"agencyname\" #Agencyname=\"ngModel\"\n          [class.is-invalid]=\"Agencyname.invalid && Agencyname.touched\" [(ngModel)]=\"agencyName\" class=\"form-control\" required>\n        <small class=\"text-danger\" [class.d-none]=\"Agencyname.valid || Agencyname.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"address\" class=\"form-label\">Adresa:</label>\n        <input type=\"text\" id=\"address\" name=\"address\" #Address=\"ngModel\"\n          [class.is-invalid]=\"Address.invalid && Address.touched\" [(ngModel)]=\"address\" class=\"form-control\" required>\n        <small class=\"text-danger\" [class.d-none]=\"Address.valid || Address.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"desc\" class=\"form-label\">Opis:</label>\n        <textarea id=\"desc\" name=\"desc\" #Desc=\"ngModel\"\n          [class.is-invalid]=\"Desc.invalid && Desc.touched\" [(ngModel)]=\"desc\" class=\"form-control\" rows=\"3\" required></textarea>\n        <small class=\"text-danger\" [class.d-none]=\"Desc.valid || Desc.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"email\" class=\"form-label\">Email:</label>\n        <input type=\"email\" id=\"email\" name=\"email\" #Email=\"ngModel\"\n          [class.is-invalid]=\"Email.invalid && Email.touched\" [(ngModel)]=\"email\" class=\"form-control\"\n          pattern=\"[^@ \\t\\r\\n]+@[^@ \\t\\r\\n]+\\.[^@ \\t\\r\\n]+\" required>\n        <div *ngIf=\"Email.errors && (Email.invalid && Email.touched) \">\n          <small class=\"text-danger\" *ngIf=\"Email.errors['required']\">Ovo polje je obavezno.</small>\n          <small class=\"text-danger\" *ngIf=\"Email.errors['pattern']\">Nije validan format mejla.</small>\n        </div>\n        <label for=\"phone\" class=\"form-label\">Broj Telefona:</label>\n        <input type=\"text\" id=\"phone\" name=\"phone\" #Phone=\"ngModel\"\n          [class.is-invalid]=\"Phone.invalid && Phone.touched\" [(ngModel)]=\"phone\" class=\"form-control\"\n          pattern=\"^(\\+)(3816)([0-9]){6,9}|(06)([0-9]){6,9}$\" required>\n        <div *ngIf=\"Phone.errors && (Phone.invalid && Phone.touched) \">\n          <small class=\"text-danger\" *ngIf=\"Phone.errors['required']\">Ovo polje je obavezno.</small>\n          <small class=\"text-danger\" *ngIf=\"Phone.errors['pattern']\">Telefon se navodi u formatu 06 (ili +3816), zatim Vas broj bez razmaka ili crtica.</small>\n        </div>\n        <input type=\"submit\" value=\"Izmeni podatke\" [disabled]=\"changeForm.form.invalid || changeForm.form.pristine || changeForm.submitted\" (click)=\"changeData()\" class=\"btn btn-primary mt-2\">\n        <small class=\"text-success d-block\" *ngIf=\"dataChange\">Uspešna izmena podataka!</small>\n        <small class=\"text-danger d-block\" *ngIf=\"dataChangeFail\">Greška pri izmeni podataka!</small>\n      </form>\n\n      <hr>\n      <h4>Izmena Lozinke</h4>\n      <form #passForm = \"ngForm\">\n        <label for=\"password\" class=\"form-label\">Lozinka:</label>\n        <input type=\"password\" name=\"password\" [(ngModel)]=\"password\" class=\"form-control\">\n        <label for=\"newPassword\" class=\"form-label\">Nova Lozinka:</label>\n        <input type=\"password\" id=\"newPassword\" name=\"newPassword\" #newPass=\"ngModel\"\n          [class.is-invalid]=\"newPass.invalid && newPass.touched\" [(ngModel)]=\"newPassword\" class=\"form-control\"\n          pattern=\"^(?=[A-Za-z]*?[A-Za-z])(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$ %^&*-]).{7,12}$\" required>\n          <div *ngIf=\"newPass.errors && (newPass.invalid && newPass.touched)\">\n            <small class=\"text-danger\" *ngIf=\"newPass.errors['required']\">Ovo polje je obavezno.</small>\n            <small class=\"text-danger\" *ngIf=\"newPass.errors['pattern']\">Lozinka mora imati izmedju 7 i 12 karaktera,\n              jedno veliko slovo, jednu cifru i jedan specijalan karakter i mora pocinjati slovom.</small>\n          </div>\n        <label for=\"confirm\" class=\"form-label\">Ponovi Lozinku:</label>\n        <input type=\"password\" id=\"confirm\" name=\"confirm\" #Confirm=\"ngModel\"\n          [class.is-invalid]=\"(Confirm.value != newPass.value) && Confirm.touched\" [(ngModel)]=\"confirm\" class=\"form-control\">\n        <small class=\"text-danger d-block\" [class.d-none]=\"(Confirm.value == newPass.value) || Confirm.untouched\">Lozinke se ne poklapaju.</small>\n\n        <input [disabled]=\"passForm.form.invalid || Confirm.value != newPass.value || passForm.submitted\" type=\"submit\" value=\"Izmeni lozinku\" (click)=\"changePass()\" class=\"btn btn-primary mt-2\">\n        <small class=\"text-success d-block\" *ngIf=\"passChange\">{{passChangeText}}</small>\n        <small class=\"text-danger d-block\" *ngIf=\"passChangeFail\">{{passChangeText}}</small>\n      </form>\n    </div>\n    <div class=\"col-md-6 d-flex flex-column align-items-center\">\n        <h4 class=\"text-center\">Trenutna Profilna Ikonica</h4>\n        <img [src]=\"'http://localhost:4000/images/' + logged.img\" class=\"rounded\" alt=\"Slika nije pronađena\">\n        <label for=\"profile_pic\" class=\"form-label mt-2\">Nova Profilna Ikonica:</label>\n        <input type=\"file\" id=\"profile_pic\" [class.is-invalid]=\"badChosen\" name=\"profile_pic\" accept=\".png, .jpg, .jpeg\" (input)=\"fileChosen($event)\" class=\"form-control w-50\">\n        <small class=\"text-danger w-50\" *ngIf=\"badChosen\">Slika mora biti velicine 100x100px - 300x300px.</small>\n        <button [disabled]=\"badChosen || !img\" class=\"btn btn-primary mt-3\" (click)=\"changeImg()\">Izmenite Profilnu Ikonicu</button>\n        <small class=\"text-success d-block\" *ngIf=\"imgChange\">{{imgChangeText}}</small>\n        <small class=\"text-danger d-block\" *ngIf=\"imgChangeFail\">{{imgChangeText}}</small>\n    </div>\n  </div>\n\n</div>\n\n<app-footer></app-footer>\n","import { Component, OnInit } from '@angular/core';\nimport { User } from '../models/user';\nimport { Router } from '@angular/router';\nimport { UserService } from '../services/user.service';\n\n\n@Component({\n  selector: 'app-agency',\n  templateUrl: './agency.component.html',\n  styleUrls: ['./agency.component.css']\n})\nexport class AgencyComponent implements OnInit {\n\n  allUsers: User[];\n\n  logged: User;\n  agencyName: string;\n  address: string;\n  email: string;\n  phone: string;\n  desc: string;\n  dataChange: boolean = false;\n  dataChangeFail: boolean = false;\n  password: string;\n  newPassword: string;\n  confirm: string;\n  passChange: boolean = false;\n  passChangeFail: boolean = false;\n  passChangeText: string;\n  badChosen: boolean = false;\n  img: File;\n  imgChange: boolean = false;\n  imgChangeFail: boolean = false;\n  imgChangeText: string;\n\n  constructor(private router: Router, private usrService: UserService) { }\n\n  ngOnInit(): void {\n    this.logged = JSON.parse(sessionStorage.getItem(\"loggedIn\"))\n    if(this.logged && this.logged.type == 1) {\n      this.agencyName = this.logged.agencyName;\n      this.address = this.logged.address;\n      this.desc = this.logged.desc;\n      this.email = this.logged.email;\n      this.phone = this.logged.phone;\n      this.usrService.fetchUsers().subscribe((users: User[]) => {\n        this.allUsers = users;\n      })\n    }\n    else this.router.navigate([''])\n  }\n\n  changeData() {\n\n    for(let u of this.allUsers) {\n      if (this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    this.usrService.editAgencyData(this.logged.username, this.logged.agencyName, this.address, this.desc, this.email, this.phone).subscribe((response) => {\n      if(response['status'] == \"ok\") { //podaci izmenjeni u bazi, sada moraju da se izmene u sessionStorage\n        this.dataChange = true;\n        this.logged.agencyName = this.agencyName;\n        this.logged.address = this.address;\n        this.logged.desc = this.desc;\n        this.logged.phone = this.phone;\n        this.logged.email = this.email;\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n      }\n      else this.dataChangeFail = true\n    })\n  }\n\n  changePass() {\n    this.usrService.editPassword(this.logged.username, this.password, this.newPassword).subscribe((response) => {\n      if(response) {\n        //sifra je uspesno promenjena ako se poklopio jedan korisnik, a to se desi ako je user+pass kombinacija dobra\n        if(response['matchedCount'] == 1) {\n          this.passChange = true\n          this.passChangeText = \"Uspešno izmenjena lozinka!\"\n          this.logged.password = this.password\n          sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged))\n        }\n        else {\n          this.passChangeFail = true\n          this.passChangeText = \"Pogrešno uneta stara lozinka!\"\n        }\n      }\n      else {\n        this.passChangeFail = true\n        this.passChangeText = \"Greška pri izmeni lozinke!\"\n      }\n\n    })\n  }\n\n  async fileChosen(event:any) {\n    //isto kao kod registracije\n    if(event.target.value) {\n      this.img = <File>event.target.files[0]\n      let img = new Image();\n      img.src = URL.createObjectURL(this.img);\n      await img.decode();\n      if(img.naturalWidth < 100 || img.naturalWidth > 300 || img.naturalHeight < 100 || img.naturalHeight > 300) this.badChosen = true;\n      else this.badChosen = false;\n    }\n    else {\n      this.badChosen = false;\n      this.img = null;\n    }\n  }\n\n  changeImg() {\n    //isto kao kod registracije\n    let form = new FormData()\n    form.append(\"profile_pic\", this.img)\n    form.append(\"user\", this.logged.username)\n    this.usrService.editImg(form).subscribe((response) => {\n      if(response['status'] == 'ok') {\n        this.imgChange = true;\n        this.imgChangeText = \"Ikonica uspešno izmenjena!\"\n        this.logged.img = response[\"newImg\"]\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged))\n        this.ngOnInit()\n      }\n      else {\n        this.imgChangeFail = true;\n        this.imgChangeText = \"Greška pri izmeni ikonice!\"\n      }\n    })\n  }\n}\n\n"]},"metadata":{},"sourceType":"module"}