{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Pc/Desktop/RTI 3. god/6. semestar/PIA/Projekat/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/user.service\";\nimport * as i2 from \"../services/request.service\";\nimport * as i3 from \"../services/worker.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"../navbar/navbar.component\";\nimport * as i8 from \"../footer/footer.component\";\n\nfunction UserDetailsComponent_div_5_div_25_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_5_div_25_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Nije validan format mejla.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_5_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, UserDetailsComponent_div_5_div_25_small_1_Template, 2, 0, \"small\", 32);\n    i0.ɵɵtemplate(2, UserDetailsComponent_div_5_div_25_small_2_Template, 2, 0, \"small\", 32);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r9 = i0.ɵɵreference(24);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r9.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r9.errors[\"pattern\"]);\n  }\n}\n\nfunction UserDetailsComponent_div_5_div_30_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_5_div_30_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Telefon se navodi u formatu 06 (ili +3816), zatim Vas broj bez razmaka ili crtica.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_5_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, UserDetailsComponent_div_5_div_30_small_1_Template, 2, 0, \"small\", 32);\n    i0.ɵɵtemplate(2, UserDetailsComponent_div_5_div_30_small_2_Template, 2, 0, \"small\", 32);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r11 = i0.ɵɵreference(29);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r11.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r11.errors[\"pattern\"]);\n  }\n}\n\nfunction UserDetailsComponent_div_5_small_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 33);\n    i0.ɵɵtext(1, \"Uspe\\u0161na izmena podataka!\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_5_small_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 34);\n    i0.ɵɵtext(1, \"Gre\\u0161ka pri izmeni podataka!\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"form\", null, 13)(3, \"label\", 14);\n    i0.ɵɵtext(4, \"Ime Agencije:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"input\", 15, 16);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_5_Template_input_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.agencyName = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"small\", 17);\n    i0.ɵɵtext(8, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"label\", 18);\n    i0.ɵɵtext(10, \"Adresa:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 19, 20);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_5_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.address = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"small\", 17);\n    i0.ɵɵtext(14, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"label\", 21);\n    i0.ɵɵtext(16, \"Opis:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"textarea\", 22, 23);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_5_Template_textarea_ngModelChange_17_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.desc = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"small\", 17);\n    i0.ɵɵtext(20, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"label\", 24);\n    i0.ɵɵtext(22, \"Email:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"input\", 25, 26);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_5_Template_input_ngModelChange_23_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.email = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(25, UserDetailsComponent_div_5_div_25_Template, 3, 2, \"div\", 27);\n    i0.ɵɵelementStart(26, \"label\", 28);\n    i0.ɵɵtext(27, \"Broj Telefona:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"input\", 29, 30);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_5_Template_input_ngModelChange_28_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r24 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r24.phone = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(30, UserDetailsComponent_div_5_div_30_Template, 3, 2, \"div\", 27);\n    i0.ɵɵelementStart(31, \"input\", 31);\n    i0.ɵɵlistener(\"click\", function UserDetailsComponent_div_5_Template_input_click_31_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.changeAgencyData());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(32, UserDetailsComponent_div_5_small_32_Template, 2, 0, \"small\", 10);\n    i0.ɵɵtemplate(33, UserDetailsComponent_div_5_small_33_Template, 2, 0, \"small\", 11);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const _r5 = i0.ɵɵreference(2);\n\n    const _r6 = i0.ɵɵreference(6);\n\n    const _r7 = i0.ɵɵreference(12);\n\n    const _r8 = i0.ɵɵreference(18);\n\n    const _r9 = i0.ɵɵreference(24);\n\n    const _r11 = i0.ɵɵreference(29);\n\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵclassProp(\"is-invalid\", _r6.invalid && _r6.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.agencyName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"d-none\", _r6.valid || _r6.untouched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", _r7.invalid && _r7.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.address);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"d-none\", _r7.valid || _r7.untouched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", _r8.invalid && _r8.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.desc);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"d-none\", _r8.valid || _r8.untouched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", _r9.invalid && _r9.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r9.errors && _r9.invalid && _r9.touched);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"is-invalid\", _r11.invalid && _r11.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.phone);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r11.errors && _r11.invalid && _r11.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", _r5.form.invalid || _r5.form.pristine || _r5.submitted);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.dataChange);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.dataChangeFail);\n  }\n}\n\nfunction UserDetailsComponent_div_6_div_19_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_6_div_19_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Nije validan format mejla.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_6_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, UserDetailsComponent_div_6_div_19_small_1_Template, 2, 0, \"small\", 32);\n    i0.ɵɵtemplate(2, UserDetailsComponent_div_6_div_19_small_2_Template, 2, 0, \"small\", 32);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r29 = i0.ɵɵreference(18);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r29.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r29.errors[\"pattern\"]);\n  }\n}\n\nfunction UserDetailsComponent_div_6_div_24_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_6_div_24_small_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 17);\n    i0.ɵɵtext(1, \"Telefon se navodi u formatu 06 (ili +3816), zatim Vas broj bez razmaka ili crtica.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_6_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, UserDetailsComponent_div_6_div_24_small_1_Template, 2, 0, \"small\", 32);\n    i0.ɵɵtemplate(2, UserDetailsComponent_div_6_div_24_small_2_Template, 2, 0, \"small\", 32);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n\n    const _r31 = i0.ɵɵreference(23);\n\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r31.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r31.errors[\"pattern\"]);\n  }\n}\n\nfunction UserDetailsComponent_div_6_small_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 33);\n    i0.ɵɵtext(1, \"Uspe\\u0161na izmena podataka!\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_6_small_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 34);\n    i0.ɵɵtext(1, \"Gre\\u0161ka pri izmeni podataka!\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r40 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"form\", null, 35)(3, \"label\", 36);\n    i0.ɵɵtext(4, \"Ime:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"input\", 37, 38);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_6_Template_input_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r40);\n      const ctx_r39 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r39.firstname = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"small\", 34);\n    i0.ɵɵtext(8, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"label\", 39);\n    i0.ɵɵtext(10, \"Prezime:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 40, 41);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_6_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r40);\n      const ctx_r41 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r41.lastname = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"small\", 34);\n    i0.ɵɵtext(14, \"Ovo polje je obavezno.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"label\", 24);\n    i0.ɵɵtext(16, \"Email:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"input\", 25, 26);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_6_Template_input_ngModelChange_17_listener($event) {\n      i0.ɵɵrestoreView(_r40);\n      const ctx_r42 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r42.email = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(19, UserDetailsComponent_div_6_div_19_Template, 3, 2, \"div\", 27);\n    i0.ɵɵelementStart(20, \"label\", 28);\n    i0.ɵɵtext(21, \"Broj Telefona:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"input\", 29, 30);\n    i0.ɵɵlistener(\"ngModelChange\", function UserDetailsComponent_div_6_Template_input_ngModelChange_22_listener($event) {\n      i0.ɵɵrestoreView(_r40);\n      const ctx_r43 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r43.phone = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(24, UserDetailsComponent_div_6_div_24_Template, 3, 2, \"div\", 27);\n    i0.ɵɵelementStart(25, \"input\", 31);\n    i0.ɵɵlistener(\"click\", function UserDetailsComponent_div_6_Template_input_click_25_listener() {\n      i0.ɵɵrestoreView(_r40);\n      const ctx_r44 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r44.changeClientData());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(26, UserDetailsComponent_div_6_small_26_Template, 2, 0, \"small\", 10);\n    i0.ɵɵtemplate(27, UserDetailsComponent_div_6_small_27_Template, 2, 0, \"small\", 11);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const _r26 = i0.ɵɵreference(2);\n\n    const _r27 = i0.ɵɵreference(6);\n\n    const _r28 = i0.ɵɵreference(12);\n\n    const _r29 = i0.ɵɵreference(18);\n\n    const _r31 = i0.ɵɵreference(23);\n\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵclassProp(\"is-invalid\", _r27.invalid && _r27.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.firstname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"d-none\", _r27.valid || _r27.untouched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", _r28.invalid && _r28.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.lastname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassProp(\"d-none\", _r28.valid || _r28.untouched);\n    i0.ɵɵadvance(4);\n    i0.ɵɵclassProp(\"is-invalid\", _r29.invalid && _r29.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r29.errors && _r29.invalid && _r29.touched);\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"is-invalid\", _r31.invalid && _r31.touched);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.phone);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r31.errors && _r31.invalid && _r31.touched);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", _r26.form.invalid || _r26.form.pristine || _r26.submitted);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.dataChange);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.dataChangeFail);\n  }\n}\n\nfunction UserDetailsComponent_small_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 42);\n    i0.ɵɵtext(1, \"Slika mora biti velicine 100x100px - 300x300px.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserDetailsComponent_small_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.imgChangeText);\n  }\n}\n\nfunction UserDetailsComponent_small_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r4.imgChangeText);\n  }\n}\n\nexport class UserDetailsComponent {\n  constructor(userService, requestService, workerService, router, route) {\n    this.userService = userService;\n    this.requestService = requestService;\n    this.workerService = workerService;\n    this.router = router;\n    this.route = route;\n    this.isLoading = true;\n    this.hasRequest = false;\n    this.dataChange = false;\n    this.dataChangeFail = false;\n    this.passChange = false;\n    this.passChangeFail = false;\n    this.badChosen = false;\n    this.imgChange = false;\n    this.imgChangeFail = false;\n  }\n\n  ngOnInit() {\n    this.logged = JSON.parse(sessionStorage.getItem(\"loggedIn\"));\n\n    if (!this.logged || this.logged.type != 2) {\n      sessionStorage.clear();\n      this.router.navigate(['']);\n    } else {\n      let username = this.route.snapshot.paramMap.get(\"username\");\n      this.userService.fetchUsers().subscribe(users => {\n        this.allUsers = users;\n        this.userService.getUser(username).subscribe(usr => {\n          this.user = usr;\n\n          if (usr.type == 1) {\n            this.userService.getReviews(username).subscribe(revs => {\n              this.reviews = revs;\n              this.workerService.getAllFromAgency(username).subscribe(allWorkers => {\n                this.workers = allWorkers;\n                this.requestService.getWorkersRequest(username).subscribe(req => {\n                  if (req) {\n                    this.hasRequest = true;\n                    this.request = req;\n                  } else {\n                    this.hasRequest = false;\n                    this.request = null;\n                  }\n\n                  this.isLoading = false;\n                });\n              });\n            });\n          } else this.isLoading = false;\n        });\n      });\n    }\n  }\n\n  fileChosen(event) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      //isto kao kod registracije\n      if (event.target.value) {\n        _this.img = event.target.files[0];\n        let img = new Image();\n        img.src = URL.createObjectURL(_this.img);\n        yield img.decode();\n        if (img.naturalWidth < 100 || img.naturalWidth > 300 || img.naturalHeight < 100 || img.naturalHeight > 300) _this.badChosen = true;else _this.badChosen = false;\n      } else {\n        _this.badChosen = false;\n        _this.img = null;\n      }\n    })();\n  }\n\n  changeImg() {\n    //isto kao kod registracije\n    let form = new FormData();\n    form.append(\"profile_pic\", this.img);\n    form.append(\"user\", this.logged.username);\n    this.userService.editImg(form).subscribe(response => {\n      if (response['status'] == 'ok') {\n        this.imgChange = true;\n        this.imgChangeText = \"Ikonica uspešno izmenjena!\";\n        this.logged.img = response[\"newImg\"];\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n        this.ngOnInit();\n      } else {\n        this.imgChangeFail = true;\n        this.imgChangeText = \"Greška pri izmeni ikonice!\";\n      }\n    });\n  }\n\n  changeClientData() {\n    for (let u of this.allUsers) {\n      if (this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    this.userService.editClientData(this.logged.username, this.firstname, this.lastname, this.phone, this.email).subscribe(response => {\n      if (response['status'] == \"ok\") {\n        //podaci izmenjeni u bazi, sada moraju da se izmene u sessionStorage\n        this.dataChange = true;\n        this.logged.firstName = this.firstname;\n        this.logged.lastName = this.lastname;\n        this.logged.phone = this.phone;\n        this.logged.email = this.email;\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n      } else this.dataChangeFail = true;\n    });\n  }\n\n  changeAgencyData() {\n    for (let u of this.allUsers) {\n      if (this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    this.userService.editAgencyData(this.logged.username, this.logged.agencyName, this.address, this.desc, this.email, this.phone).subscribe(response => {\n      if (response['status'] == \"ok\") {\n        //podaci izmenjeni u bazi, sada moraju da se izmene u sessionStorage\n        this.dataChange = true;\n        this.logged.agencyName = this.agencyName;\n        this.logged.address = this.address;\n        this.logged.desc = this.desc;\n        this.logged.phone = this.phone;\n        this.logged.email = this.email;\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n      } else this.dataChangeFail = true;\n    });\n  }\n\n}\n\nUserDetailsComponent.ɵfac = function UserDetailsComponent_Factory(t) {\n  return new (t || UserDetailsComponent)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.RequestService), i0.ɵɵdirectiveInject(i3.WorkerService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i4.ActivatedRoute));\n};\n\nUserDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: UserDetailsComponent,\n  selectors: [[\"app-user-details\"]],\n  decls: 20,\n  vars: 9,\n  consts: [[1, \"container\", \"mb-5\", \"mt-5\"], [1, \"row\"], [\"class\", \"col-md-6\", 4, \"ngIf\"], [1, \"col-md-6\", \"d-flex\", \"flex-column\", \"align-items-center\"], [1, \"text-center\"], [\"alt\", \"Slika nije prona\\u0111ena\", 1, \"rounded\", 3, \"src\"], [\"for\", \"profile_pic\", 1, \"form-label\", \"mt-2\"], [\"type\", \"file\", \"id\", \"profile_pic\", \"name\", \"profile_pic\", \"accept\", \".png, .jpg, .jpeg\", 1, \"form-control\", \"w-50\", 3, \"input\"], [\"class\", \"text-danger w-50\", 4, \"ngIf\"], [1, \"btn\", \"btn-primary\", \"mt-3\", 3, \"disabled\", \"click\"], [\"class\", \"text-success d-block\", 4, \"ngIf\"], [\"class\", \"text-danger d-block\", 4, \"ngIf\"], [1, \"col-md-6\"], [\"changeAgencyForm\", \"ngForm\"], [\"for\", \"agencyname\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"agencyname\", \"name\", \"agencyname\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Agencyname\", \"ngModel\"], [1, \"text-danger\"], [\"for\", \"address\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"address\", \"name\", \"address\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Address\", \"ngModel\"], [\"for\", \"desc\", 1, \"form-label\"], [\"id\", \"desc\", \"name\", \"desc\", \"rows\", \"3\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Desc\", \"ngModel\"], [\"for\", \"email\", 1, \"form-label\"], [\"type\", \"email\", \"id\", \"email\", \"name\", \"email\", \"pattern\", \"[^@ \\\\t\\\\r\\\\n]+@[^@ \\\\t\\\\r\\\\n]+\\\\.[^@ \\\\t\\\\r\\\\n]+\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Email\", \"ngModel\"], [4, \"ngIf\"], [\"for\", \"phone\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"phone\", \"name\", \"phone\", \"pattern\", \"^(\\\\+)(3816)([0-9]){6,9}|(06)([0-9]){6,9}$\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Phone\", \"ngModel\"], [\"type\", \"submit\", \"value\", \"Izmeni podatke\", 1, \"btn\", \"btn-primary\", \"mt-2\", 3, \"disabled\", \"click\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [1, \"text-success\", \"d-block\"], [1, \"text-danger\", \"d-block\"], [\"changeUserForm\", \"ngForm\"], [\"for\", \"firstname\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"firstname\", \"name\", \"firstname\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Firstname\", \"ngModel\"], [\"for\", \"lastname\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"lastname\", \"name\", \"lastname\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"Lastname\", \"ngModel\"], [1, \"text-danger\", \"w-50\"]],\n  template: function UserDetailsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-navbar\");\n      i0.ɵɵelementStart(1, \"div\", 0)(2, \"h4\");\n      i0.ɵɵtext(3, \"Izmena podataka\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"div\", 1);\n      i0.ɵɵtemplate(5, UserDetailsComponent_div_5_Template, 34, 26, \"div\", 2);\n      i0.ɵɵtemplate(6, UserDetailsComponent_div_6_Template, 28, 21, \"div\", 2);\n      i0.ɵɵelementStart(7, \"div\", 3)(8, \"h4\", 4);\n      i0.ɵɵtext(9, \"Trenutna Profilna Ikonica\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"img\", 5);\n      i0.ɵɵelementStart(11, \"label\", 6);\n      i0.ɵɵtext(12, \"Nova Profilna Ikonica:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"input\", 7);\n      i0.ɵɵlistener(\"input\", function UserDetailsComponent_Template_input_input_13_listener($event) {\n        return ctx.fileChosen($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(14, UserDetailsComponent_small_14_Template, 2, 0, \"small\", 8);\n      i0.ɵɵelementStart(15, \"button\", 9);\n      i0.ɵɵlistener(\"click\", function UserDetailsComponent_Template_button_click_15_listener() {\n        return ctx.changeImg();\n      });\n      i0.ɵɵtext(16, \"Izmenite Profilnu Ikonicu\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(17, UserDetailsComponent_small_17_Template, 2, 1, \"small\", 10);\n      i0.ɵɵtemplate(18, UserDetailsComponent_small_18_Template, 2, 1, \"small\", 11);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelement(19, \"app-footer\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", ctx.user.type == 1);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.user.type == 0);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"src\", \"http://localhost:4000/images/\" + ctx.logged.img, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(3);\n      i0.ɵɵclassProp(\"is-invalid\", ctx.badChosen);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.badChosen);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", ctx.badChosen || !ctx.img);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.imgChange);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.imgChangeFail);\n    }\n  },\n  dependencies: [i5.NgIf, i6.ɵNgNoValidate, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.RequiredValidator, i6.PatternValidator, i6.NgModel, i6.NgForm, i7.NavbarComponent, i8.FooterComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ1c2VyLWRldGFpbHMuY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","UserDetailsComponent","constructor","userService","requestService","workerService","router","route","ngOnInit","logged","JSON","parse","sessionStorage","getItem","type","clear","navigate","username","snapshot","paramMap","get","fetchUsers","subscribe","users","allUsers","getUser","usr","user","getReviews","revs","reviews","getAllFromAgency","allWorkers","workers","getWorkersRequest","req","hasRequest","request","isLoading","fileChosen","event","target","value","img","files","Image","src","URL","createObjectURL","decode","naturalWidth","naturalHeight","badChosen","changeImg","form","FormData","append","editImg","response","imgChange","imgChangeText","setItem","stringify","imgChangeFail","changeClientData","u","email","alert","editClientData","firstname","lastname","phone","dataChange","firstName","lastName","dataChangeFail","changeAgencyData","editAgencyData","agencyName","address","desc","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Pc\\Desktop\\RTI 3. god\\6. semestar\\PIA\\Projekat\\frontend\\src\\app\\user-details\\user-details.component.html","C:\\Users\\Pc\\Desktop\\RTI 3. god\\6. semestar\\PIA\\Projekat\\frontend\\src\\app\\user-details\\user-details.component.ts"],"sourcesContent":["<app-navbar></app-navbar>\n\n<div class=\"container mb-5 mt-5\">\n  <h4>Izmena podataka</h4>\n\n  <div class=\"row\">\n    <div class=\"col-md-6\" *ngIf=\"user.type == 1\">\n      <form #changeAgencyForm=\"ngForm\">\n        <label for=\"agencyname\" class=\"form-label\">Ime Agencije:</label>\n        <input type=\"text\" id=\"agencyname\" name=\"agencyname\" #Agencyname=\"ngModel\"\n          [class.is-invalid]=\"Agencyname.invalid && Agencyname.touched\" [(ngModel)]=\"agencyName\" class=\"form-control\" required>\n        <small class=\"text-danger\" [class.d-none]=\"Agencyname.valid || Agencyname.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"address\" class=\"form-label\">Adresa:</label>\n        <input type=\"text\" id=\"address\" name=\"address\" #Address=\"ngModel\"\n          [class.is-invalid]=\"Address.invalid && Address.touched\" [(ngModel)]=\"address\" class=\"form-control\" required>\n        <small class=\"text-danger\" [class.d-none]=\"Address.valid || Address.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"desc\" class=\"form-label\">Opis:</label>\n        <textarea id=\"desc\" name=\"desc\" #Desc=\"ngModel\"\n          [class.is-invalid]=\"Desc.invalid && Desc.touched\" [(ngModel)]=\"desc\" class=\"form-control\" rows=\"3\" required></textarea>\n        <small class=\"text-danger\" [class.d-none]=\"Desc.valid || Desc.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"email\" class=\"form-label\">Email:</label>\n        <input type=\"email\" id=\"email\" name=\"email\" #Email=\"ngModel\"\n          [class.is-invalid]=\"Email.invalid && Email.touched\" [(ngModel)]=\"email\" class=\"form-control\"\n          pattern=\"[^@ \\t\\r\\n]+@[^@ \\t\\r\\n]+\\.[^@ \\t\\r\\n]+\" required>\n        <div *ngIf=\"Email.errors && (Email.invalid && Email.touched) \">\n          <small class=\"text-danger\" *ngIf=\"Email.errors['required']\">Ovo polje je obavezno.</small>\n          <small class=\"text-danger\" *ngIf=\"Email.errors['pattern']\">Nije validan format mejla.</small>\n        </div>\n        <label for=\"phone\" class=\"form-label\">Broj Telefona:</label>\n        <input type=\"text\" id=\"phone\" name=\"phone\" #Phone=\"ngModel\"\n          [class.is-invalid]=\"Phone.invalid && Phone.touched\" [(ngModel)]=\"phone\" class=\"form-control\"\n          pattern=\"^(\\+)(3816)([0-9]){6,9}|(06)([0-9]){6,9}$\" required>\n        <div *ngIf=\"Phone.errors && (Phone.invalid && Phone.touched) \">\n          <small class=\"text-danger\" *ngIf=\"Phone.errors['required']\">Ovo polje je obavezno.</small>\n          <small class=\"text-danger\" *ngIf=\"Phone.errors['pattern']\">Telefon se navodi u formatu 06 (ili +3816), zatim Vas broj bez razmaka ili crtica.</small>\n        </div>\n        <input type=\"submit\" value=\"Izmeni podatke\" [disabled]=\"changeAgencyForm.form.invalid || changeAgencyForm.form.pristine || changeAgencyForm.submitted\" (click)=\"changeAgencyData()\" class=\"btn btn-primary mt-2\">\n        <small class=\"text-success d-block\" *ngIf=\"dataChange\">Uspešna izmena podataka!</small>\n        <small class=\"text-danger d-block\" *ngIf=\"dataChangeFail\">Greška pri izmeni podataka!</small>\n      </form>\n    </div>\n    <div class=\"col-md-6\" *ngIf=\"user.type == 0\">\n      <form #changeUserForm=\"ngForm\">\n        <label for=\"firstname\" class=\"form-label\">Ime:</label>\n        <input type=\"text\" id=\"firstname\" name=\"firstname\" #Firstname=\"ngModel\"\n          [class.is-invalid]=\"Firstname.invalid && Firstname.touched\" [(ngModel)]=\"firstname\" class=\"form-control\" required>\n        <small class=\"text-danger d-block\" [class.d-none]=\"Firstname.valid || Firstname.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"lastname\" class=\"form-label\">Prezime:</label>\n        <input type=\"text\" id=\"lastname\" name=\"lastname\" #Lastname=\"ngModel\"\n          [class.is-invalid]=\"Lastname.invalid && Lastname.touched\" [(ngModel)]=\"lastname\" class=\"form-control\" required>\n        <small class=\"text-danger d-block\" [class.d-none]=\"Lastname.valid || Lastname.untouched\">Ovo polje je obavezno.</small>\n        <label for=\"email\" class=\"form-label\">Email:</label>\n        <input type=\"email\" id=\"email\" name=\"email\" #Email=\"ngModel\"\n          [class.is-invalid]=\"Email.invalid && Email.touched\" [(ngModel)]=\"email\" class=\"form-control\"\n          pattern=\"[^@ \\t\\r\\n]+@[^@ \\t\\r\\n]+\\.[^@ \\t\\r\\n]+\" required>\n        <div *ngIf=\"Email.errors && (Email.invalid && Email.touched) \">\n          <small class=\"text-danger\" *ngIf=\"Email.errors['required']\">Ovo polje je obavezno.</small>\n          <small class=\"text-danger\" *ngIf=\"Email.errors['pattern']\">Nije validan format mejla.</small>\n        </div>\n        <label for=\"phone\" class=\"form-label\">Broj Telefona:</label>\n        <input type=\"text\" id=\"phone\" name=\"phone\" #Phone=\"ngModel\"\n          [class.is-invalid]=\"Phone.invalid && Phone.touched\" [(ngModel)]=\"phone\" class=\"form-control\"\n          pattern=\"^(\\+)(3816)([0-9]){6,9}|(06)([0-9]){6,9}$\" required>\n        <div *ngIf=\"Phone.errors && (Phone.invalid && Phone.touched) \">\n          <small class=\"text-danger\" *ngIf=\"Phone.errors['required']\">Ovo polje je obavezno.</small>\n          <small class=\"text-danger\" *ngIf=\"Phone.errors['pattern']\">Telefon se navodi u formatu 06 (ili +3816), zatim Vas broj bez razmaka ili crtica.</small>\n        </div>\n        <input type=\"submit\" value=\"Izmeni podatke\" [disabled]=\"changeUserForm.form.invalid || changeUserForm.form.pristine || changeUserForm.submitted\" (click)=\"changeClientData()\" class=\"btn btn-primary mt-2\">\n        <small class=\"text-success d-block\" *ngIf=\"dataChange\">Uspešna izmena podataka!</small>\n        <small class=\"text-danger d-block\" *ngIf=\"dataChangeFail\">Greška pri izmeni podataka!</small>\n      </form>\n    </div>\n    <div class=\"col-md-6 d-flex flex-column align-items-center\">\n        <h4 class=\"text-center\">Trenutna Profilna Ikonica</h4>\n        <img [src]=\"'http://localhost:4000/images/' + logged.img\" class=\"rounded\" alt=\"Slika nije pronađena\">\n        <label for=\"profile_pic\" class=\"form-label mt-2\">Nova Profilna Ikonica:</label>\n        <input type=\"file\" id=\"profile_pic\" [class.is-invalid]=\"badChosen\" name=\"profile_pic\" accept=\".png, .jpg, .jpeg\" (input)=\"fileChosen($event)\" class=\"form-control w-50\">\n        <small class=\"text-danger w-50\" *ngIf=\"badChosen\">Slika mora biti velicine 100x100px - 300x300px.</small>\n        <button [disabled]=\"badChosen || !img\" class=\"btn btn-primary mt-3\" (click)=\"changeImg()\">Izmenite Profilnu Ikonicu</button>\n        <small class=\"text-success d-block\" *ngIf=\"imgChange\">{{imgChangeText}}</small>\n        <small class=\"text-danger d-block\" *ngIf=\"imgChangeFail\">{{imgChangeText}}</small>\n    </div>\n  </div>\n\n</div>\n\n<app-footer></app-footer>\n","import { Component, OnInit } from '@angular/core';\nimport { User } from '../models/user';\nimport { UserService } from '../services/user.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Review } from '../models/review';\nimport { MyRequest } from '../models/myrequest';\nimport { RequestService } from '../services/request.service';\nimport { AgencyWorker } from '../models/worker';\nimport { WorkerService } from '../services/worker.service';\n\n@Component({\n  selector: 'app-user-details',\n  templateUrl: './user-details.component.html',\n  styleUrls: ['./user-details.component.css']\n})\nexport class UserDetailsComponent implements OnInit {\n\n  allUsers: User[];\n\n  isLoading: boolean = true;\n  user: User;\n  logged: User;\n  reviews: Review[];\n  workers: AgencyWorker[];\n  request: MyRequest;\n  hasRequest: boolean = false;\n\n  firstname: string;\n  lastname: string;\n  agencyName: string;\n  address: string;\n  email: string;\n  phone: string;\n  desc: string;\n  dataChange: boolean = false;\n  dataChangeFail: boolean = false;\n  password: string;\n  newPassword: string;\n  confirm: string;\n  passChange: boolean = false;\n  passChangeFail: boolean = false;\n  passChangeText: string;\n  badChosen: boolean = false;\n  img: File;\n  imgChange: boolean = false;\n  imgChangeFail: boolean = false;\n  imgChangeText: string;\n\n  constructor(private userService: UserService, private requestService: RequestService,\n    private workerService: WorkerService, private router: Router, private route: ActivatedRoute) { }\n\n  ngOnInit(): void {\n    this.logged = JSON.parse(sessionStorage.getItem(\"loggedIn\"));\n    if(!this.logged || this.logged.type != 2) {\n      sessionStorage.clear();\n      this.router.navigate(['']);\n    }\n    else {\n      let username = this.route.snapshot.paramMap.get(\"username\");\n      this.userService.fetchUsers().subscribe((users: User[]) => {\n        this.allUsers = users;\n        this.userService.getUser(username).subscribe((usr: User) => {\n          this.user = usr;\n          if(usr.type == 1) {\n            this.userService.getReviews(username).subscribe((revs: Review[]) => {\n              this.reviews = revs;\n              this.workerService.getAllFromAgency(username).subscribe((allWorkers: AgencyWorker[]) => {\n                this.workers = allWorkers;\n                this.requestService.getWorkersRequest(username).subscribe((req: MyRequest) => {\n                  if(req) {\n                    this.hasRequest = true;\n                    this.request = req;\n                  }\n                  else {\n                    this.hasRequest = false;\n                    this.request = null;\n                  }\n                  this.isLoading = false;\n                })\n              })\n            })\n          }\n          else this.isLoading = false;\n        })\n      })\n    }\n  }\n\n  async fileChosen(event:any) {\n    //isto kao kod registracije\n    if(event.target.value) {\n      this.img = <File>event.target.files[0]\n      let img = new Image();\n      img.src = URL.createObjectURL(this.img);\n      await img.decode();\n      if(img.naturalWidth < 100 || img.naturalWidth > 300 || img.naturalHeight < 100 || img.naturalHeight > 300) this.badChosen = true;\n      else this.badChosen = false;\n    }\n    else {\n      this.badChosen = false;\n      this.img = null;\n    }\n  }\n\n  changeImg() {\n    //isto kao kod registracije\n    let form = new FormData()\n    form.append(\"profile_pic\", this.img)\n    form.append(\"user\", this.logged.username)\n    this.userService.editImg(form).subscribe((response) => {\n      if(response['status'] == 'ok') {\n        this.imgChange = true;\n        this.imgChangeText = \"Ikonica uspešno izmenjena!\"\n        this.logged.img = response[\"newImg\"]\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged))\n        this.ngOnInit()\n      }\n      else {\n        this.imgChangeFail = true;\n        this.imgChangeText = \"Greška pri izmeni ikonice!\"\n      }\n    })\n  }\n\n  changeClientData() {\n\n    for(let u of this.allUsers) {\n      if (this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    this.userService.editClientData(this.logged.username, this.firstname, this.lastname, this.phone, this.email).subscribe((response) => {\n      if(response['status'] == \"ok\") {\n\n        //podaci izmenjeni u bazi, sada moraju da se izmene u sessionStorage\n        this.dataChange = true\n        this.logged.firstName = this.firstname\n        this.logged.lastName = this.lastname\n        this.logged.phone = this.phone\n        this.logged.email = this.email\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged))\n      }\n      else this.dataChangeFail = true\n    })\n  }\n\n  changeAgencyData() {\n\n    for(let u of this.allUsers) {\n      if (this.email == u.email) {\n        alert(\"Email nije jedinstven!\");\n        return;\n      }\n    }\n\n    this.userService.editAgencyData(this.logged.username, this.logged.agencyName, this.address, this.desc, this.email, this.phone).subscribe((response) => {\n      if(response['status'] == \"ok\") { //podaci izmenjeni u bazi, sada moraju da se izmene u sessionStorage\n        this.dataChange = true;\n        this.logged.agencyName = this.agencyName;\n        this.logged.address = this.address;\n        this.logged.desc = this.desc;\n        this.logged.phone = this.phone;\n        this.logged.email = this.email;\n        sessionStorage.setItem(\"loggedIn\", JSON.stringify(this.logged));\n      }\n      else this.dataChangeFail = true\n    })\n  }\n\n}\n"]},"metadata":{},"sourceType":"module"}